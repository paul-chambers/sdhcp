#!/bin/sh

echo "`date` $STATE $IFNAME $LEASE"  >> /tmp/sdhcp.log

# dnsmasq expects this
RESOLV=/run/dnsmasq/resolv.conf

if [ -n "$DNS" ]; then
	echo "nameserver $DNS" > $RESOLV
	[ -n "$DNS2" ] && echo "nameserver $DNS2" >> $RESOLV
	[ -n "$DOMAIN" ] && echo "search $DOMAIN" >> $RESOLV
	pkill -HUP dnsmasq
fi

if [ -n "$DOMAIN" ]; then
	cat << EOF > /etc/resolv.conf
# Generated by $0
nameserver 127.0.0.1
search $DOMAIN
EOF
fi
